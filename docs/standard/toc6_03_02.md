# 6.3.2 論理一貫性

## 6.3.2 論理一貫性

論理一貫性とは、データの構造、属性及び関係に関する論理的規則の遵守の度合いであり、以下の四つから構成される。

- 概念一貫性：応用スキーマに一致しているか否か
- 定義域一貫性：定義域に含まれているか否か
- 書式一貫性：XMLのフォーマットに従っているか否か
- 位相一貫性：応用スキーマに定義した位相的な特性が正しいか否か

**表 6-13**

| No | L01 |
| --- | --- |
| 品質要素 | 論理一貫性・書式一貫性 |
| 品質適用範囲 | データ製品に含まれる全ての都市モデル（core:CityModel）のインスタンス。 |
| 品質評価尺度 | 整形式(Well-Formed XML)になっていない箇所数。 |
| 適合品質水準 | エラーの数が0個の場合に合格。エラーの数が1以上の場合は不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．検査プログラム（XMLパーサなど）によって、都市モデルの書式が、XML文書の構文として正しくない箇所を数える。 |

**表 6-14**

| No | L02 |
| --- | --- |
| 品質要素 | 論理一貫性・概念一貫性 |
| 品質適用範囲 | データ製品に含まれる全ての都市モデル（core:CityModel）のインスタンス。 |
| 品質評価尺度 | 妥当（Valid）なXML文書になっていない箇所数。 |
| 適合品質水準 | エラーの数が0個の場合に合格。エラーの数が1以上の場合は不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．検査プログラム（XMLパーサなど）によって、都市モデルに含まれる地物型の構造が、7.1に符号化仕様として示すi-UR及びCityGMLのXMLSchemaが規定する構造と合致しない箇所を数える。 |

**表 6-15**

| No | L03 |
| --- | --- |
| 品質要素 | 論理一貫性・概念一貫性 |
| 品質適用範囲 | データ製品に含まれる全ての都市モデル（core:CityModel）のインスタンス。 |
| 品質評価尺度 | 応用スキーマに定義していない地物型の出現箇所数。 |
| 適合品質水準 | エラーの数が0個の場合に合格。エラーの数が1以上の場合は不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．検査プログラムによって、各都市の拡張製品仕様書の4章に示す応用スキーマ（応用スキーマクラス図及び応用スキーマ文書）に定義されている地物以外の地物インスタンスが、都市モデルの子要素として出現する箇所を数える。 |

**表 6-16**

| No | L04 |
| --- | --- |
| 品質要素 | 論理一貫性・定義域一貫性 |
| 品質適用範囲 | gml:CodeTypeを型としてもつ地物属性のうち、コードリストを参照している地物属性。 |
| 品質評価尺度 | 指定されたコードリストに定義されていない値となっている箇所数。 |
| 適合品質水準 | エラーの数が0個の場合に合格。エラーの数が1以上の場合は不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．gml:CodeTypeに含まれるコードリストへの相対パスを取得する。手順2．相対パスで指定されたコードリストに定義された全てのコード値（gml:nameにより記述）を取得する。手順3．検査プログラムにより、地物属性の値と取得した全てのコード値との比較を行い、地物属性の値が、コード値と合致しない箇所を数える。 |
| 注記6.3.2の注記コードリストへの相対パスは、gml:CodeTypeの属性であるcodeSpaceの値として記述されている。 | ← |

**表 6-17**

| No | L05 |
| --- | --- |
| 品質要素 | 論理一貫性・定義域一貫性 |
| 品質適用範囲 | 全ての都市モデル（core:CityModel）のインスタンス。 |
| 品質評価尺度 | 都市モデルに指定された空間参照系の識別子が、製品仕様書で指定された識別子ではない。 |
| 適合品質水準 | エラーの数が0個の場合に合格。エラーの数が1以上の場合は不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．都市モデルに含まれるgml:Envelopeに記述された空間参照系のURIが、製品仕様書に示されたURIに合致しない箇所を数える。 |
| 注記6.3.2の注記空間参照系のURIは、gml:Envelopeの属性であるsrsNameの値として記述されている。 | ← |

**表 6-18**

| No | L06 |
| --- | --- |
| 品質要素 | 論理一貫性・定義域一貫性 |
| 品質適用範囲 | 全ての幾何オブジェクトのインスタンス。 |
| 品質評価尺度 | 幾何オブジェクトインスタンスの座標値に含まれる、緯度、経度、標高が、この幾何オブジェクトインスタンスを含む都市モデル（core:CityModel）の空間範囲に含まれる。 |
| 適合品質水準 | エラーとなる幾何オブジェクトが0個の場合に合格。エラーとなる幾何オブジェクトが1個以上の場合は不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．都市モデルに含まれるgml:Envelopeの属性boundedByに記述された、緯度、経度及び標高の下限値及び上限値を超える座標値を有する幾何オブジェクトをエラーとする。 |

**表 6-19**

| No | L07 |
| --- | --- |
| 品質要素 | 論理一貫性・位相一貫性 |
| 品質適用範囲 | BIMモデルから変換したbldg:Building及びbldg:Buildingが含む、下位の地物インスタンスが持つgml:LineString及びgml:LinearRingのインスタンスを除く、全てのgml:LineString及びgml:LinearRingのインスタンス。 |
| 品質評価尺度 | 同一座標又は頂点間での距離が近接閾値（0.01m）未満の頂点が連続する、又はgml:LineString及びgml:LinearRingのインスタンスを構成する点が2点未満のインスタンスをエラーとする。 |
| 適合品質水準 | エラーの数が0個の場合に合格。1以上なら不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．検査プログラムによって、対象となる幾何オブジェクトインスタンスごとに、エラーの数を数える。 |

**表 6-20**

| No | L08 |
| --- | --- |
| 品質要素 | 論理一貫性・位相一貫性 |
| 品質適用範囲 | 全てのgml:LineStringのインスタンス。 |
| 品質評価尺度 | 単一インスタンスに始終点以外の「自己交差」又は「自己接触」が存在する場合にエラーとする。 |
| 適合品質水準 | エラーの数が0個の場合に合格。1以上なら不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．検査プログラムによって、対象となる幾何オブジェクトインスタンスごとに、エラーの数を数える。 |

**表 6-21**

| No | L09 |
| --- | --- |
| 品質要素 | 論理一貫性・位相一貫性 |
| 品質適用範囲 | 全てのgml:LinearRingのインスタンス。 |
| 品質評価尺度 | 全てのgml:Ringのインスタンスの始終点の座標が一致していない、「自己交差」、「自己接触」、又は始終点以外に重複する座標値が存在するインスタンスをエラーとする。 |
| 適合品質水準 | エラーの数が0個の場合に合格。1以上なら不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．検査プログラムによって、対象となる幾何オブジェクトインスタンスごとに、エラーの数を数える。 |

**表 6-22**

| No | L10 |
| --- | --- |
| 品質要素 | 論理一貫性・位相一貫性 |
| 品質適用範囲 | 全てのgml:Polygon及びgml:_SurfacePatchの下位クラスのインスタンス。 |
| 品質評価尺度 | 座標列の向きが不正なインスタンスをエラーとする。外周は反時計回り、内周は時計回りが正しい。 |
| 適合品質水準 | エラーの数が0個の場合に合格。1以上なら不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．検査プログラムによって、対象となる幾何オブジェクトインスタンスごとに、エラーの数を数える。 |

**表 6-23**

| No | L11 |
| --- | --- |
| 品質要素 | 論理一貫性・位相一貫性 |
| 品質適用範囲 | LOD1の地物の空間属性に使用されるgml:Polygonのインスタンス。 |
| 品質評価尺度 | gml:Polygonの境界を構成する全ての座標値が同一平面上になければならない。同一平面上にない座標値が存在するインスタンスをエラーとする。 |
| 適合品質水準 | エラーの数が0個の場合に合格。1以上なら不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．検査プログラムによって、対象となる幾何オブジェクトインスタンスごとに、エラーの数を数える。 |

**表 6-24**

| No | L12 |
| --- | --- |
| 品質要素 | 論理一貫性・位相一貫性 |
| 品質適用範囲 | LOD2又はLOD3の空間属性に使用されるgml:Polygonのインスタンス。 |
| 品質評価尺度 | gml:Polygonの境界を構成する全ての座標値が同一平面とみなす許容誤差（0.03m）内に存在しなければならない。同一平面とみなす許容誤差内に存在しない座標値が存在するインスタンスをエラーとする。同一平面とみなす許容誤差は、作成に使用する原典資料や作成方法により異なるため、作業者が許容誤差案を作成し、監督員の確認を得てから品質評価を実施すること。 |
| 適合品質水準 | エラーの数が0個の場合に合格。1以上なら不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．検査プログラムによって、対象となる幾何オブジェクトインスタンスごとに、エラーの数を数える。 |

**表 6-25**

| No | L13 |
| --- | --- |
| 品質要素 | 論理一貫性・位相一貫性 |
| 品質適用範囲 | 内周が存在するgml:Polygonのインスタンス。 |
| 品質評価尺度 | gml:Polygonに内周が存在する場合に、以下に示す条件に一つ以上に合致する場合にエラーとする。内周が外周と交差している。内周と外周が接することにより、gml:Polygonが二つ以上に分割されている。内周同士が重なったり、包含関係にあったりする。 |
| 適合品質水準 | エラーの数が0個の場合に合格。1以上なら不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．検査プログラムによって、対象となる幾何オブジェクトインスタンスごとに、エラーの数を数える。 |

**表 6-26**

| No | L14 |
| --- | --- |
| 品質要素 | 論理一貫性・位相一貫性 |
| 品質適用範囲 | 全てのgml:Solidのインスタンス。 |
| 品質評価尺度 | gml:Solidを構成する全ての境界面が、以下の条件を満たしていない場合にエラーとする。境界面が自己交差していない。閉じている。全ての境界面の向きが立体の外側を向いている。境界面が立体を分断していてはならない。境界面が交差してはならない。 |
| 適合品質水準 | エラーの数が0個の場合に合格。1以上なら不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．検査プログラムによって、対象となる幾何オブジェクトインスタンスごとに、エラーの数を数える。 |

**表 6-27**

| No | L15 |
| --- | --- |
| 品質要素 | 論理一貫性・位相一貫性 |
| 品質適用範囲 | 全てのgml:Triangleのインスタンス。 |
| 品質評価尺度 | 始点と終点が一致する4点の座標値から構成されていない場合に、エラーとする。 |
| 適合品質水準 | エラーの数が0個の場合に合格。1以上なら不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．検査プログラムによって、対象となる幾何オブジェクトインスタンスごとに、エラーの数を数える。 |

**表 6-28**

| No | L16 |
| --- | --- |
| 品質要素 | 論理一貫性・位相一貫性 |
| 品質適用範囲 | 全てのgml:TriangulatedSurface及びこの下位クラスのインスタンス。 |
| 品質評価尺度 | gml:TriangulatedSurfaceの境界が閉じている場合にエラーとする。 |
| 適合品質水準 | エラーの数が0個の場合に合格。1以上なら不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．検査プログラムによって、対象となる幾何オブジェクトインスタンスごとに、エラーの数を数える。 |

**表 6-29**

| No | L17 |
| --- | --- |
| 品質要素 | 論理一貫性・位相一貫性 |
| 品質適用範囲 | 全てのgml:CompositeCurveのインスタンス。 |
| 品質評価尺度 | gml:CompositeCurveを構成する（最初のgml:LineStringを除いた）gml:LineStringの始点が、直前のgml:LineStringの終点の座標と一致していない場合にエラーとする。 |
| 適合品質水準 | エラーの数が0個の場合に合格。1以上なら不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．検査プログラムによって、対象となる幾何オブジェクトインスタンスごとに、エラーの数を数える。 |

**表 6-30**

| No | L18 |
| --- | --- |
| 品質要素 | 論理一貫性・位相一貫性 |
| 品質適用範囲 | 全てのgml:CompositeSurfaceのインスタンス。 |
| 品質評価尺度 | gml:CompositeSurfaceを構成するgml:Polygonが、以下の場合にエラーとする。同じgml:CompositeSurfaceを構成する他のgml:Polygonと重なる。同じgml:CompositeSurfaceを構成する他のgml:Polygonのいずれとも接していない。 |
| 適合品質水準 | エラーの数が0個の場合に合格。1以上なら不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．検査プログラムによって、対象となる幾何オブジェクトインスタンスごとに、エラーの数を数える。 |

**表 6-31**

| No | L-bldg-01 |
| --- | --- |
| 品質要素 | 論理一貫性・位相一貫性 |
| 品質適用範囲 | bldg:Buildingのインスタンス。 |
| 品質評価尺度 | bldg:Buildingが空間属性として保持する立体（gml:Solid）同士が重ならない。 |
| 適合品質水準 | エラーとなるインスタンスが0個の場合に合格。エラーとなるbldg:Buildingが1個以上の場合は不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．全てのインスタンスについて、bldg:lod1Solid及びbldg:lod2Solidにより構成されるgml:Solidを抽出する。手順2．抽出したgml:Solidのうち、重なるべきではないgml:Solid同士が交差している場合にエラーとする。 |

**表 6-32**

| No | L-bldg-02 |
| --- | --- |
| 品質要素 | 論理一貫性・位相一貫性 |
| 品質適用範囲 | bldg:BuildingPartをもつbldg:Buildingのインスタンス。 |
| 品質評価尺度 | 1つのbldg:Buildingについて、これを構成するbldg:BuildingPartが空間属性として保持する立体（gml:Solid）同士が離れていない。 |
| 適合品質水準 | エラーとなるインスタンスが0個の場合に合格。エラーとなるbldg:Buildingインスタンスが1個以上の場合は不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．bldg:BuildingPartをもつbldg:Buildingインスタンスを抽出する。手順2．それぞれのインスタンスについて、これを構成する全てのgml:Solidを抽出し、境界面を共有していないgml:Solidが存在している場合にエラーとする。 |

**表 6-33**

| No | L-bldg-03 |
| --- | --- |
| 品質要素 | 論理一貫性・位相一貫性 |
| 品質適用範囲 | bldg:Window及びbldg:Doorのインスタンス。 |
| 品質評価尺度 | bldg:_Openingの下位クラスのインスタンスが、これを集約するbldg:_BoundarySurfaceの下位クラスのインスタンスに包含されていない場合にエラーとする。 |
| 適合品質水準 | エラーとなるbldg:Window、bldg:Doorのインスタンスが0個の場合に合格。エラーとなるインスタンスが1個以上の場合は不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．開口部（bldg:Window、bldg:Door）の空間属性として保持するgml:MultiSurfaceを、これを集約する境界面（bldg:_BoundarySurfaceの下位クラス）の空間属性が保持するgml:MultiSurface上に投影する。手順2．投影されたbldg:Window及びbldg:Doorのgml:MultiSurfaceの一部又は全部が境界面の外側に存在するbldg:Window及びbldg:Doorのインスタンス数を数える。 |

**表 6-34**

| No | L-bldg-04 |
| --- | --- |
| 品質要素 | 論理一貫性・概念一貫性 |
| 品質適用範囲 | bldg:Building |
| 品質評価尺度 | bldg:Buildingの用途を示す属性が正しい階層構造を保っている。 |
| 適合品質水準 | エラー数が0なら合格、1以上なら不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．データ製品に含まれる全てのbldg:Buildingインスタンスについて、属性「uro:majorUsage2」をもつインスタンスを抽出する。手順2．属性「uro:majorUsage」をもたない場合にエラーとし、その数を数える。 |

**表 6-35**

| No | L-bldg-05 |
| --- | --- |
| 品質要素 | 論理一貫性・概念一貫性 |
| 品質適用範囲 | bldg:Building |
| 品質評価尺度 | bldg:Buildingの用途を示す属性が正しい階層構造を保っている。 |
| 適合品質水準 | エラー数が0なら合格、1以上なら不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．データ製品に含まれる全ての建築物インスタンスについて、属性「uro:detailedUsage2」又は「uro:detailedUsage3」をもつインスタンスを抽出する。手順2．属性「uro:detailedUsage2」をもつインスタンスは属性「uro:detailedUsage」を、属性「uro:detailedUsage3」をもつインスタンスは属性「uro:detailedUsage2」を、それぞれもたない場合にエラーとし、その数を数える。 |

**表 6-36**

| No | L-bldg-06 |
| --- | --- |
| 品質要素 | 論理一貫性・概念一貫性 |
| 品質適用範囲 | bldg:Building,bldg:BuildingPart |
| 品質評価尺度 | bldg:Building又はbldg:BuildingPartのbldg:lod2Solid及びbldg:lod3Solidにより記述される立体（gml:Solid）の境界面（gml:CompositeSurface）に含まれる多角形（gml:Polygon）は、bldg:boundedByにより参照する、bldg:RoofSurface,bldg:WallSurface,bldg:GroundSurface,bldg:OuterFloorSurface,bldg:OuterCeilingSurface,bldg:ClosureSurface及びこれらが参照する開口部（bldg:Door,bldg:Window）により記述される面（gml:MultiSurface）に含まれる多角形（gml:Polygon）のいずれかでなければならない。 |
| 適合品質水準 | エラー数が0なら合格、1以上なら不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．検査プログラムによって、bldg:lod2Solid又はbldg:lod3Solidにより記述される立体（gml:Solid）の境界面（gml:CompositeSurface）が参照する多角形（gml:Polygon）のgml:idが、bldg:boundedByにより参照するbldg:RoofSurface,bldg:WallSurface,bldg:GroundSurface,bldg:OuterFloorSurface,bldg:OuterCeilingSurface,bldg:ClosureSurface及びこれらが参照する開口部（bldg:Door,bldg:Window）の面（gml:MultiSurface）の構成要素となる多角形（gml:Polygon）のgml:idと一致していない場合にエラーとする。 |

**表 6-37**

| No | L-bldg-07（境界面と開口部との位相） |
| --- | --- |
| 品質要素 | 論理一貫性・位相一貫性 |
| 品質適用範囲 | bldg:_BoundarySurfaceの下位型及びbldg:_Openingの下位型のインスタンス。 |
| 品質評価尺度 | bldg:_Openingの下位クラスのインスタンスの空間属性（bldg:lod4MultiSurface）が、これを集約するbldg:_BoundarySurfaceの下位クラスのインスタンスの空間属性（bldg:lod4MultiSurface）と境界線を共有していない場合にエラーとする。 |
| 適合品質水準 | エラーとなるbldg:Window、bldg:Doorのインスタンスが0個の場合に合格。エラーとなるインスタンスが1個以上の場合は不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．開口部（bldg:Window、bldg:Door）の空間属性が保持するgml:MultiSurfaceを、これを集約する境界面（bldg:_BoundarySurfaceの下位クラス）の空間属性が保持するgml:MultiSurfaceを抽出する。手順2．bldg:Window及びbldg:Doorのgml:MultiSurfaceが境界面のgml:MultiSurfaceと境界線を共有していないbldg:Window及びbldg:Doorのインスタンス数を数える。 |

**表 6-38**

| No | L-bldg-08（bldg:BuildingのLOD4が境界面に区分されていること） |
| --- | --- |
| 品質要素 | 論理一貫性・概念一貫性 |
| 品質適用範囲 | bldg:Building |
| 品質評価尺度 | bldg:Buildingのbldg:lod4Solid又はbldg:lod4MultiSurfaceを構成するgml:Polygonが、bldg:Buildingに含まれるbldg:_BoundarySurfaceの下位型、bldg:_Openingの下位型、又はbldg:BuildingInstallationのgml:Polygonのいずれかでなければならない。 |
| 適合品質水準 | エラー数が0なら合格、1以上なら不合格。 |
| 品質評価手法 | 全数検査を実施する。手順1．検査プログラムによって、bldg:lod4Solidにより記述される立体（gml:Solid）の境界面（gml:CompositeSurface）が参照する多角形（gml:Polygon）又はbldg:lod4MultiSurfaceにより記述される面の集まり（gml:MultiSurface）に含まれる多角形（gml:Polygon）のgml:idが、以下のいずれかに一致していない場合にエラーとする。bldg:boundedByにより参照するbldg:RoofSurface,bldg:WallSurface,bldg:GroundSurface,bldg:OuterFloorSurface,bldg:OuterCeilingSurface,bldg:ClosureSurface及びこれらが参照する開口部（bldg:Door,bldg:Window）の面（gml:MultiSurface）の構成要素となる多角形（gml:Polygon）のgml:idbldg:outerBuildingInstallationにより参照するbldg:BuildingInstallationの境界面となるbldg:RoofSurface,bldg:WallSurface,bldg:GroundSurface,bldg:OuterFloorSurface,bldg:OuterCeilingSurface,bldg:ClosureSurface及びこれらが参照する開口部（bldg:Door,bldg:Window）の面（gml:MultiSurface）の構成要素となる多角形（gml:Polygon）のgml:id |

**表 6-39**

| No | L-bldg-09（bldg:RoomのLOD4が境界面に区分されていること） |
| --- | --- |
| 品質要素 | 論理一貫性・概念一貫性 |
| 品質適用範囲 | bldg:Room |
| 品質評価尺度 | bldg:Roomのbldg:lod4Solidを構成するgml:Polygonが、bldg:Roomに含まれるbldg:_BoundarySurfaceの下位型又はbldg:_Openingの下位型のgml:Polygonのいずれかでなければならない。 |
| 適合品質水準 | エラー数が0なら合格、1以上なら不合格。 |
| 品質評価手法 | 全数検査を実施する。手順1．検査プログラムによって、bldg:lod4Solidにより記述される立体（gml:Solid）の境界面（gml:CompositeSurface）が参照する多角形（gml:Polygon）のgml:idが、以下のいずれかに一致していない場合にエラーとする。bldg:boundedByにより参照するbldg:CeilingSurface,bldg:InteriorWallSurface,bldg:FloorSurface,bldg:ClosureSurface及びこれらが参照する開口部（bldg:Door,bldg:Window）の面（gml:MultiSurface）の構成要素となる多角形（gml:Polygon）のgml:id |

**表 6-40**

| No | L-bldg-10（屋内・屋外の境界面の向き） |
| --- | --- |
| 品質要素 | 論理一貫性・位相一貫性 |
| 品質適用範囲 | bldg:_BoundarySurfaceの下位型。 |
| 品質評価尺度 | 建築物（bldg:Building）の外形を構成する境界面は常に法線ベクトルが外向きであり、部屋（bldg:Building）を構成する境界面は、常に法線ベクトルが内向きである。 |
| 適合品質水準 | エラー数が0なら合格、1以上なら不合格。 |
| 品質評価手法 | 全数検査を実施する。手順1．検査プログラムによって、以下のエラーをカウントする。bldg:Buildingのbldg:boundedByにより保持されるbldg:_BoundarySurfaceの法線ベクトルの向きが、建築物の内側を向いている場合bldg:BuildingInstallationのbldg:boundedByにより保持されるbldg:_BoundarySurfaceの法線ベクトルの向きが、建築物の内側を向いている場合bldg:Roomのbldg:boundedByにより保持されるbldg:_BoundarySurfaceの法線ベクトルの向きが、建築物の外側を向いている場合bldg:IntBuildingInstallationのbldg:boundedByにより保持されるbldg:_BoundarySurfaceの法線ベクトルの向きが、建築物の外側を向いている場合 |

**表 6-41**

| No | L-bldg-11（部屋を構成する幾何オブジェクトと、境界面との関係） |
| --- | --- |
| 品質要素 | 論理一貫性・概念一貫性 |
| 品質適用範囲 | bldg:Room |
| 品質評価尺度 | bldg:Roomのbldg:lod4Solidにより記述される立体又はbldg:lod4MultiSurfaceにより記述される面の集まりであるgml:Polygonが、bldg:Roomが参照する境界面又はbldg:IntBuildingInstallationの境界面となgml:Polgonがの反対の向きとなる。 |
| 適合品質水準 | エラー数が0なら合格、1以上なら不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．検査プログラムによって、bldg:Roomのbldg:lod4Solidにより記述される立体（gml:Solid）の境界面（gml:CompositeSurface）の構成要素（gml:surfaceMember）又はbldg:lod4MultiSurfaceにより記述される面の集まり（gml:MultiSurface）の構成要素（gml:surfaceMember）が、以下のいずれかに一致していない場合にエラーとする。gml:surfaceMemberにより参照される面がorientationの値が”-“となるgml:OrientableSurfaceではない。gml:OrientableSurfaceが、gml:baseSurfaceにより参照するgml:idが、以下のいずれにも該当しない。bldg:boundedByにより参照するbldg:InteriorWallSurface,bldg:FloorSurface,bldg:CeilingSurface,bldg:ClosureSurface及びこれらが参照する開口部（bldg:Door,bldg:Window）の面（gml:MultiSurface）の構成要素となる多角形（gml:Polygon）のgml:idbldg:roomInstallationにより参照する、bldg:IntBuildingInstallationがbldg:boundedByにより参照する、bldg:InteriorWallSurface,bldg:CeilingSurface,bldg:FloorSurface,bldg:ClosureSurface及びこれらが参照する開口部（bldg:Door,bldg:Window）により記述される面（gml:MultiSurface）に含まれる多角形（gml:Polygon）のgml:id |

**表 6-42**

| No | L-bldg-12（建築物と屋内に存在する地物との相対的な位置関係） |
| --- | --- |
| 品質要素 | 論理一貫性・位相一貫性 |
| 品質適用範囲 | bldg:Building、bldg:Room、bldg:IntBuildingInstallation、bldg:BuildingFurniture |
| 品質評価尺度 | 全てのbldg:Room、bldg:IntBuildingInstallation、bldg:BuildingFurnitureの幾何オブジェクト（gml:Solid又はgml:MultiSurface）が、これを含むbldg:Buildingの幾何オブジェクト（gml:Solid又はgml:MultiSurface）の内側に含まれていなければならない。 |
| 適合品質水準 | エラー数が0なら合格、1以上なら不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．検査プログラムによって、全てのbldg:Room、bldg:IntBuildingInstallation、bldg:BuildingFurnitureのLOD4の幾何オブジェクトに含まれるgml:Polygonが、bldg:Buildingの幾何オブジェクトと交差しているgml:Polygonの数をカウントする。手順2．検査プログラムによって、全てのbldg:Room、bldg:IntBuildingInstallation、bldg:BuildingFurnitureのLOD4の幾何オブジェクトに含まれるgml:Polygonの外側（負となる向き）に、bldg:Buildingの幾何オブジェクトが存在していないgml:Polygonの数をカウントする。手順3．手順1．及び手順2．の合計をエラー数とする。 |

**表 6-43**

| No | L-frn-01 |
| --- | --- |
| 品質要素 | 論理一貫性・概念一貫性 |
| 品質適用範囲 | 空間属性として、lod1Geometry,lod2Geomatry又はlod3Geometryをもつ全ての地物型のインスタンス。 |
| 品質評価尺度 | 空間属性により保持又は参照する幾何オブジェクトの型が、応用スキーマ文書で指定された幾何オブジェクト（gml:MultiSurface又はgml:Solid）ではないインスタンスの個数。 |
| 適合品質水準 | エラーの箇所が0個の場合に合格。エラーの箇所数が1以上の場合は不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．検査プログラムによって、対象となるインスタンスを検索する。手順2．検索されたインスタンスの空間属性の型が、応用スキーマ文書と合致しないインスタンスを数える。 |

**表 6-44**

| No | L-frn-02 |
| --- | --- |
| 品質要素 | 論理一貫性・概念一貫性 |
| 品質適用範囲 | 空間属性として、lod0Geometryをもつ全ての地物型のインスタンス。 |
| 品質評価尺度 | 空間属性により保持又は参照する幾何オブジェクトの型が、応用スキーマ文書で指定された幾何オブジェクト（gml:Point, gml:MultiPoint, gml:MultiCurve又はgml:MultiSurface）ではないインスタンスの個数。 |
| 適合品質水準 | エラーの箇所が0個の場合に合格。エラーの箇所数が1以上の場合は不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．検査プログラムによって、対象となるインスタンスを検索する。手順2．検索されたインスタンスの空間属性の型が、応用スキーマ文書と合致しないインスタンスを数える。 |

**表 6-45**

| No | L-tran-01 |
| --- | --- |
| 品質要素 | 論理一貫性・位相一貫性 |
| 品質適用範囲 | tran:Road、tran:TrafficArea、tran:AuxiliaryTrafficArea |
| 品質評価尺度 | 延長方向に連続するインスタンスの空間属性（tran:lod2MultiSurface及びtran:lod3MultiSurface）が、境界線を共有していない場合をエラーとする。 |
| 適合品質水準 | エラーとなるインスタンスが0個の場合に合格。エラーとなるインスタンスが1個以上の場合は不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。同一の地物型かつ同一のLODで記述されている空間属性に対して実施する。手順1．道路の延長方向に連続する全ての同一の地物型かつ同一のLODの空間属性をもつペアを抽出する。手順2．全てのインスタンスのペアについて、“境界線で接する”、”離れている”のいずれにも該当しないオブジェクトのペアの数を数える。 |

**表 6-46**

| No | L-tran-02 |
| --- | --- |
| 品質要素 | 論理一貫性・位相一貫性 |
| 品質適用範囲 | tran:TrafficArea、tran:AuxiliaryTrafficArea |
| 品質評価尺度 | 同一の道路インスタンスに含まれる交通領域及び交通補助領域の空間属性（tran:lod2MultiSurface及びtran:lod3MultiSurface）は、境界線を共有するか、又は、離れているかのいずれかであり、それ以外の場合にエラーとする。ただし、以下は例外とする。中央帯と分離帯（分離帯は中央帯に含まれる場合がある。）中央帯と側帯（側帯は中央帯に含まれる場合がある。）路肩と側帯（側帯は路肩に含まれる場合がある。） |
| 適合品質水準 | エラーとなるインスタンスが0個の場合に合格。エラーとなるインスタンスが1個以上の場合は不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。同一のLODで記述されている空間属性に対して実施する。手順1．対象となる地物の全インスタンスのペアを抽出する。手順2．全てのインスタンスのペアについて、“境界線で接する”に該当しないインスタンスの数を数える。 |

**表 6-47**

| No | L-tran-03 |
| --- | --- |
| 品質要素 | 論理一貫性・位相一貫性 |
| 品質適用範囲 | tran:Road、tran:TrafficArea、tran:AuxiliaryTrafficArea |
| 品質評価尺度 | tran:Roadインスタンスに含まれるtran:TrafficAreaインスタンス及びtran:AuxiliaryTrafficAreaインスタンスの空間属性（tran:lod2MultiSurface及びtran:lod3MultiSurface）に含まれる全てのMultiSurfaceを道路インスタンスが参照していない場合にエラーとする。 |
| 適合品質水準 | エラーとなるインスタンスが0個の場合に合格。エラーとなるインスタンスが1個以上の場合は不合格。 |
| 品質評価手法 | 全数・自動検査を実施する。手順1．対象となる地物の全インスタンス数を数える。手順2．全てのインスタンスのペアについて、“境界線で接する”に該当しないインスタンスの数を数える。 |

