# 7.1.2.4 変換規則

## 7.1.2.4 変換規則

## 7.1.2.4.1 スキーマ変換規則

スキーマ変換規則は、i-UR3.2及びCityGML2.0に従う。

なお、標準製品仕様書は、応用スキーマクラス図及びこれに対応するXMLSchemaを新規に作成するのではなく、i-UR3.2及びCityGML2.0から必要な部分のみを選択し、使用している。
応用スキーマクラス図に示す、クラス名、属性名及び関連役割名は、i-UR3.2及びCityGML2.0において定義されたタグに一致させている。

また、複数の名前空間から選択しているため、全てのクラス名に、i-UR3.2又はCityGML2.0名前空間の接頭辞を付ける。

## 7.1.2.4.2 インスタンス変換規則

GMLに準拠する。

- **オブジェクト識別子（gml:id）**：データ製品に含まれる全ての地物には、gml:idによる識別可能な値を与えることとし、その値には`[接頭辞]_[UUID]`を使用する。
 `[接頭辞]`は、CityGML及びi-URの各パッケージに与えられた接頭辞（表7-5）を使用する。
 `[UUID]`は、Universally Unique Identifier（UUID）とする。UUIDとは、ソフトウェア上でオブジェクトを一意に識別するための識別子であり、128ビット（16バイト）の値で表す。先頭から4ビットごとに16進数の値（0～f）に変換し、8桁-4桁-4桁-4桁-12桁に区切って表現する。
- **集成の実装**：応用スキーマに示された地物型間の集成は、部品となるオブジェクトを、全体となるオブジェクトの子要素として記述する。
この時、部品となるオブジェクトの識別子（gml:id）を、全体となるオブジェクト以外のオブジェクトが参照してもよい。
- **空間参照系の識別**：幾何オブジェクトに適用される空間参照系は、都市モデル（core:CityModel）に挿入されるEnvelop要素の属性snsNameにおいて、以下のEPSGコードを挿入することにより識別する。
  **表 7-1**

| 空間参照系の名称 | srsNameに挿入する値 |
| --- | --- |
| 日本測地系2011 における経緯度座標系と東京湾平均海面を基準とする標高の複合座標参照系 | [http://www.opengis.net/def/crs/EPSG/0/6697](http://www.opengis.net/def/crs/EPSG/0/6697) |


- **schemaLocationの指定**：i-URの符号化仕様は、3D都市モデル内のschemasフォルダ（7.2.4）に格納したXMLSchemaファイルへの相対パスによりschemaLocationを指定する。
- **出力すべきタグ**：データ製品に含まれる全ての拡張製品仕様書において作成対象とする全ての主題属性及び空間属性のタグを出力しなければならない。

