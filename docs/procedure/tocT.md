# 附属書T 妥当な水部オブジェクト

## 附属書T （規定） 妥当な水部オブジェクト

## T.1 概要

本付属書では、「3D都市モデル標準製品仕様書」（以下、「標準製品仕様書」という）に適合したデータ製品について、「水部モデル」に従って作成されるべき都市オブジェクト（「水部オブジェクト」という）が満たすべき要件と、妥当な水部オブジェクトを作成するための標準的な作業手順を示す。

**表 T-1 — T-1: 妥当な水部オブジェクト**

| ID | `/req/wtr` |
| --- | --- |
| 対象の種類 | 妥当な水部オブジェクトの要件 |
| 説明 | 水部の説明とLODの要件 |
| 規定 | 要件T-1: 水部記述のLOD対応条件要件T-2: 水部のLOD0形状定義要件T-3: 水部のLOD1形状定義要件T-4: 水部のLOD2形状定義要件T-5: 水部のLOD3形状定義 |

## T.2 水部の記述とLOD

## T.2.1 水部モデル

水部とは、河川、細流、一条河川、かれ川、用水路、湖池、海岸線、水路地下部及び低位水涯線をいう。[[付録７ 公共測量標準図式](https://www.gsi.go.jp/gijyutukanri/gijyutukanri41018.html)]

標準製品仕様書では、水部の表現に必要な地物型等をCityGML及びi-URより抽出し、LODごとに、含むべき地物型、各地物型の空間属性の型、取得基準、取得方法及び補足を定めた「水部モデル」を定義する。

水部モデルのLODは、LOD0からLOD3までを対象とする。

![Image](images/tocT_img001.png)

- 水部モデル（LOD0）では、水部の形状を、線により表現する。水部の形状の線は、河川ネットワーク又は水涯線のいずれかとする。
- 水部モデル（LOD1）では、水部の形状を、高さをもった面として表現する。
- 水部モデル（LOD2）では、水部の形状を立体として表現する。水部の立体は、水涯線により囲まれた面（水面）、水底面及び管理区間や行政区域を区切る面を境界面とする。
- 水部モデル（LOD3）では、水部の形状を立体として表現する。このとき、水部モデル（LOD2）の立体から水中にある構造物が占める空間を除いた立体となる。

## T.2.2 使用可能な地物型とLOD

水部の記述には、CityGMLのWaterBodyモジュールに定義されたwtr:WaterBodyを用いて記述する。wtr:WaterBodyは、詳細度（LOD）ごとに、使用すべき地物型やその空間属性が異なる。

**表 T-2 — T-1: 水部記述のLOD対応条件**

| ID | `/req/wtr/1` |
| --- | --- |
| 主題 | 妥当な水部データセットの要件 |
| 分類 | 要件分類T-1: 妥当な水部オブジェクト |
| 条文 | 水部の記述には、指定されたLODに対応する地物型及び空間属性を使用する。 |

WaterBodyモジュールには、水部（wtr:WaterBody）と、水部の境界面（wtr:_BoundarySurface）が定義される。水部の境界面は、水面（wtr:WaterSurface）、水底面（wtr:WaterGroundSurface）及び閉鎖面（wtr:WaterClosureSurface）に区分される。

LOD0では、Wtr:Waterbodyのみを使用し、水部の形状を線として表現する。LOD1では、wtr:WaterBodyのみを使用し、水部の形状を面として表現する。LOD2及びLOD3では、wtr:WaterBodyを使用して水部の形状を立体として表現し、その立体の境界面をwtr:WaterSurface、wtr:WaterGroundSurface又はwtr:WaterClosureSurfaceに区分する。

水部の各LODにおいて使用可能な地物型とその空間属性を表T-3に示す。

**表 T-3 — 水部モデルの記述に使用する地物型と空間属性**

| 地物型 | 空間属性 | LOD0 | LOD1 | LOD2 | LOD3 | 適用 |
| --- | --- | --- | --- | --- | --- | --- |
| wtr:WaterBody |  | ● | ● | ● | ● |  |
| ↑ | lod0MultiCurve | ■ |  |  |  | 河川中心線（wtr:lod0MultiCurve）を基本とする。縁線、界線又は点として取得する場合はuro:lod0Geometryを使用する。 |
| ↑ | lod0Geometry | ■ |  |  |  | ↑ |
| ↑ | lod1MultiSurface |  | ● |  |  |  |
| ↑ | lod2Solid |  |  | ● |  |  |
| ↑ | lod3Solid |  |  |  | ● |  |
| wtr:WaterSurface |  |  |  | ● | ● | 水部の形状を構成する面のうち、水面に使用する。 |
| ↑ | lod2Surface |  |  | ● |  |  |
| ↑ | lod3Surface |  |  |  | ● |  |
| wtr:WaterGroundSurface |  |  |  | ● | ● | 水底の境界面に使用する。 |
| ↑ | lod2Surface |  |  | ● |  |  |
| ↑ | lod3Surface |  |  |  | ● |  |
| wtr:WaterClosureSurface |  |  |  | ■ | ■ | 仮想的な面を作成したい場合に使用する。 |
| ↑ | lod2Surface |  |  | ■ |  | WaterClosureSurfaceを作る場合は必須とする。 |
| ↑ | lod3Surface |  |  |  | ■ | ↑ |
| ●：必須■：条件付必須〇：任意（ユースケースに応じて要否を決定してよい） | ← | ← | ← | ← | ← | ← |

## T.2.3 水部の空間属性

## T.2.3.1 LOD0

水部モデル（LOD0）は、水部の形状を線又は点として記述する。このとき水部オブジェクトは、水部モデル（LOD0）の定義に従ったものでなければならない。

**表 T-4 — T-2: 水部のLOD0形状定義**

| ID | `/req/wtr/2` |
| --- | --- |
| 主題 | 妥当な水部データセットの要件 |
| 分類 | 要件分類T-1: 妥当な水部オブジェクト |
| 条文 | 水部のLOD0の形状は、水部モデル（LOD0）の定義に従う。 |

水部モデル（LOD0）は、河川中心線又は公共測量標準図式に従った表現となる。

## T.2.3.2 LOD1

水部モデル（LOD1）は、水部の形状を面として表現する。このとき、水部オブジェクトは、水部モデル（LOD1）の定義に従ったものでなければならない。

**表 T-5 — T-3: 水部のLOD1形状定義**

| ID | `/req/wtr/3` |
| --- | --- |
| 主題 | 妥当な水部データセットの要件 |
| 分類 | 要件分類T-1: 妥当な水部オブジェクト |
| 条文 | 水部のLOD1の形状は水部モデル（LOD1）の定義に従う。 |

**表 T-6 — 水部モデル（LOD1）**

|  | LOD1 |
| --- | --- |
| 取得例 | ![Image](images/tocT_img002.png) |
| 説明 | 水涯線により囲まれた面を取得する。中洲がある場合は、中洲を除いた面となる。 |

## T.2.3.3 LOD2

水部モデル（LOD2）は、水部の形状を立体として表現する。水部の立体は、水涯線により囲まれた面（水面）、水底面及び管理区間や行政区域を区切る面を境界面とする。このとき、水部オブジェクトは、水部モデル（LOD2）の定義に従ったものでなければならない。

**表 T-7 — T-4: 水部のLOD2形状定義**

| ID | `/req/wtr/4` |
| --- | --- |
| 主題 | 妥当な水部データセットの要件 |
| 分類 | 要件分類T-1: 妥当な水部オブジェクト |
| 条文 | 水部のLOD2の形状は、水部モデル（LOD2）の定義に従う。 |

**表 T-8 — 水部モデル（LOD2）**

|  | LOD2 |
| --- | --- |
| 取得例 | ![Image](images/tocT_img003.png) |
| 説明 | 水涯線により囲まれた水面（WaterSurface）及び水底面（WaterGroundSurface）を境界面とする立体を作成する。水面は水部モデル（LOD1）の面に一致する。また、水底面は、等深線や航空レーザ（ALB）又はマルチビーム測深の点群データを用いて再現した、水底の起伏を表す面となる。 境界面を水面、地表面に区分し、水部を管理区間や行政界など仮想的な面により区切りたい場合には、その境界面を閉鎖面（WaterClosureSurface）に区分する。 |

## T.2.3.4 LOD3

水部モデル（LOD3）は、水部の形状を立体として表現する。立体は、水部モデル（LOD2）の立体から水中の構造物が占める空間を除いた空間となる。このとき、水部オブジェクトは、水部モデル（LOD3）の定義に従ったものでなければならない。

**表 T-9 — T-5: 水部のLOD3形状定義**

| ID | `/req/wtr/5` |
| --- | --- |
| 主題 | 妥当な水部データセットの要件 |
| 分類 | 要件分類T-1: 妥当な水部オブジェクト |
| 条文 | 水部のLOD3の形状は、水部モデル（LOD3）の定義に従う。 |

水中にある構造物と水部の境界面は水底面とする。

**表 T-10 — 水部モデル（LOD3）**

|  | LOD3 |
| --- | --- |
| 取得例 | ![Image](images/tocT_img004.png) |
| 説明 | 水部モデル（LOD2）である、水涯線により囲まれた水面（WaterSurface）、水底面（WaterGroundSurface）及び閉鎖面（WaterClosureSurface）を境界面とする立体から、橋梁下部の橋脚部分など水中にある構造物を除いた立体となる。水中にある構造物と水部の境界面は水底面とする。 |

## T.2.4 水部の主題属性

## T.2.4.1 データ品質属性（uro:DataQualityAttribute）

水部オブジェクトの作成に使用した原典資料の記録や、適用した詳細なLODの区分を示すための属性である。
使用した原典資料やそれに基づくデータの品質、また、採用したLODは、データセットのメタデータに記録できる。ただし、データセット全体に対して一つのメタデータを作成することが基本となり、個々の都市オブジェクトの品質を記録することは困難である。

同じデータセットの中に、航空写真測量により作成したその他の構造物オブジェクトや完成図等から作成したその他の構造物オブジェクトというように、複数の品質をもつ都市オブジェクトが混在している場合には、都市オブジェクトごとにこのデータ品質属性を使用して、品質情報を記録することで、その品質を明確にできる。

そこで、標準製品仕様書では、個々のデータに対してデータ品質に関する情報を記述するための属性として、「データ品質属性」（uro:DataQualityAttribute）を定義している。データ品質属性は、属性としてデータ作成に使用した原典資料の地図情報レベル、その他原典資料の諸元及び精緻化したLODをもつ。

3D都市モデルに含まれる全ての水部モデルは、このデータ品質属性を必ず作成しなければならない。ただし、水部（wtr:WaterBody）に対してデータ品質属性を付与することはできるが、これを構成する水面等の境界面（wtr:_BoundarySurfaceの下位クラス）にデータ品質属性を付与することはできない。

## T.3 標準的な作業手順

各LODの幾何オブジェクトを作成する際の標準的な作業手順及び作業上の留意事項を示す。

## T.3.1 幾何オブジェクトの作成

幾何オブジェクトの作成に必要となる原典資料を表T-11に示す。

**表 T-11 — 原典資料一覧**

|  | 水平位置 | 水面高さ | 水底高さ | 水中構造物の形状 |
| --- | --- | --- | --- | --- |
| LOD0 | 以下のいずれかのデータを一つ以上使用する河川基盤地図都市計画基本図等のDMデータ航空写真 | ― | ― | ― |
| LOD1 | 以下のいずれかのデータを一つ以上使用する都市計画基本図等のDMデータ航空写真 | 以下のいずれかのデータを一つ以上使用する基盤地図情報等のDEM航空写真地形モデル | ― | ― |
| LOD2 | 以下のいずれかのデータを一つ以上使用する都市計画基本図等のDMデータ航空写真 | 以下のいずれかのデータを一つ以上使用する基盤地図情報等のDEM航空写真 | 以下のいずれかのデータを一つ以上使用する等深線航空レーザ（ALB）の点群マルチビーム測深の点群 | ― |
| LOD3 | 以下のいずれかのデータを一つ以上使用する都市計画基本図等のDMデータ航空写真 | 以下のいずれかのデータを一つ以上使用する基盤地図情報等のDEM航空写真 | 以下のいずれかのデータを一つ以上使用する等深線航空レーザ（ALB）の点群マルチビーム測深の点群 | 以下のいずれかのデータを一つ以上使用する水中構造物（橋梁等）の平面図及び断面図等マルチビーム測深の点群 |
| 注記T.3.1の注記原典資料の一覧に示す平面図、断面図等は設計時や竣工時に作成された水中構造物の外形が取得できる図面を指す。また、図面は紙出力された資料及びＣＡＤデータを含む。 | ← | ← | ← | ← |

## T.3.1.1 LOD0

## T.3.1.1.1 原典資料

**表 T-12 — LOD0の原典資料**

|  | 水平位置 | 水面高さ | 水底高さ | 水中構造物の形状 |
| --- | --- | --- | --- | --- |
| LOD0 | 以下のいずれかのデータを一つ以上使用する河川基盤地図都市計画基本図等のDMデータ航空写真 | ― | ― | ― |

## T.3.1.1.2 作業手順

- 作成対象とする河川を管理する河川事務所から河川基盤地図を入手し、その中から対象河川の「河心線」を抽出する。河川基盤地図が入手できない場合は、都市計画基本図等のDMデータに含まれる水涯線から中心線を作成する、又は航空写真から現況河道の中心線を図化する。
湖沼は水涯線を取得し、河川中心線はその水涯線に接するように作成する。また、海岸線は、水涯線と河川区域の境界とを結ぶ線を取得する。
- a）で抽出又は作成した河川中心線を構成する頂点の順列を調整する。
標準製品仕様書では、頂点の順列は流下方向に一致させることが規定されている。そのため、河川中心線を構成する第1点目の頂点を流下始点とし、最終点を流下終点となるように頂点の順列を調整する。 
流下方向が不明の河川又は湖沼若しくは海岸線であっても頂点の順列は一定の方向となるよう調整し、そのうえで属性flowDirectionをfalseとする。図T-2 — 湖沼、海岸線の作成イメージ

## T.3.1.2 LOD1

## T.3.1.2.1 原典資料

**表 T-13 — LOD1の原典資料**

|  | 水平位置 | 水面高さ | 水底高さ | 水中構造物の形状 |
| --- | --- | --- | --- | --- |
| LOD1 | 以下のいずれかのデータを一つ以上使用する都市計画基本図等のDMデータ航空写真 | 以下のいずれかのデータを一つ以上使用する地形モデル基盤地図情報等のDEM航空写真 | ― | ― |

## T.3.1.2.2 作業手順

- 都市計画基本図等のDMデータから、水涯線を抽出する。
- 地形モデルを入手又は作成する。
地形モデルがある場合はこれを入手し、無い場合はDEMからTIN（不規則三角網）を作成する。 
ただし、都市計画基本図等のDMデータに含まれる水涯線と地形モデル又はDEMの作成時点が異なる等、水涯線にDEMの高さを与えることができない場合は、航空写真から水涯線を三次元図化で取得する。
- a）で抽出した水涯線に、b）で作成した地形モデルを用いて高さを与える。
水涯線の各頂点に、地形モデルとの交点の高さを与え、高さ付きの水涯線を作成する（ 図T-3）。
このとき、作成された水涯線の各頂点は一律の高さではなく、それぞれ独立した高さ（地形モデルとの交点の高さ）をもつ。図T-3 — 水面に高さを付与するイメージ
- b）で作成した水涯線を外周とするポリゴン（水面）を作成する。また、中州がある場合は、中洲を除いた面となる。図T-4 — 中州を除いた水面のイメージ
- c）のポリゴンを基準地域メッシュ（第3次地域区画）の境界で区切る。
水部のインスタンスの単位は基準地域メッシュであるため、基準地域メッシュで区切る。

水部モデル（LOD1）の作成例を図T-5に示す。

![Image](images/tocT_img005.png)

## T.3.1.3 LOD2

## T.3.1.3.1 原典資料

**表 T-14 — LOD2の原典資料**

|  | 水平位置 | 水面高さ | 水底高さ | 水中構造物の形状 |
| --- | --- | --- | --- | --- |
| LOD2 | 以下のいずれかのデータを一つ以上使用する都市計画基本図等のDMデータ航空写真 | 以下のいずれかのデータを一つ以上使用する基盤地図情報等のDEM航空写真 | 以下のいずれかのデータを一つ以上使用する等深線航空レーザ（ALB）の点群マルチビーム測深の点群 | ― |

## T.3.1.3.2 作業手順

- 等深線、航空レーザ（ALB）の点群又はマルチビーム測深の点群から水底のDEMを作成する。
 DEMの格子間隔はユースケースに応じて変更してよいが、5m以下とする。湖沼の等深線は国土地理院の湖沼データ[ [https://www.gsi.go.jp/kankyochiri/lakedata.html](https://www.gsi.go.jp/kankyochiri/lakedata.html)]から入手できる。ただし、湖沼データの等深線の地図情報レベルは10000であるため、使用する場合はメタデータの識別情報＞空間解像度に10000を追記する。
- a）で作成した水底のDEMからTINを作成し、それを水底面とする。
- 水部モデル（LOD1）で作成した水面とb）で作成した水底面から立体を作成する。
- c）の立体を基準地域メッシュ（第3次地域区画）の境界で分割する。
- d）で分割した立体を構成する境界面を、地物型に区分する。
水部モデル（LOD2）は、立体を構成する境界面を区分しなければならない。水面をWaterSurface、水底面をWaterGroundSurface、基準地域メッシュ（第3次地域区画）の境界面又は作成対象範囲の境界面をWaterClosureSurfaceにそれぞれ区分する。図T-6 — 境界面の区分イメージ

水部モデル（LOD2）の作成例を図T-7及び図T-8に示す。

![Image](images/tocT_img006.png)

![Image](images/tocT_img007.png)

## T.3.1.4 LOD3

## T.3.1.4.1 原典資料

**表 T-15 — LOD3の原典資料**

|  | 水平位置 | 水面高さ | 水底高さ | 水中構造物の形状 |
| --- | --- | --- | --- | --- |
| LOD3 | 以下のいずれかのデータを一つ以上使用する都市計画基本図等のDMデータ航空写真 | 以下のいずれかのデータを一つ以上使用する基盤地図情報等のDEM航空写真 | 以下のいずれかのデータを一つ以上使用する等深線航空レーザ（ALB）の点群マルチビーム測深の点群 | 以下のいずれかのデータを一つ以上使用する水中構造物（橋梁等）の平面図及び断面図等マルチビーム測深の点群 |

## T.3.1.4.2 作業手順

- 水部モデル（LOD2）を作成する。
- マルチビーム測深の点群および水中構造物（橋梁等）の平面図及び断面図等から水中構造物の形状を取得する。
- b）で取得した形状を水部モデル（LOD2）から取り除く。
- 水中構造物と水部の境界面を、WaterGroundSurfaceとして区分する。図T-9 — 水中構造物をくりぬくイメージ

水部モデル（LOD3）の作成例を図T-10に示す。

![Image](images/tocT_img008.png)

## T.3.2 作業上の留意事項

## T.3.2.1 水部を構成する境界面の作成単位

wtr:WaterBodyを構成するwtr:WaterSurface、wtr:WaterGroundSurface、wtr:WaterClosureSurfaceは同一種の境界面が連続する範囲は3次メッシュの単位で1つのBoundarySurfaceにする。

![Image](images/tocT_img009.png)

