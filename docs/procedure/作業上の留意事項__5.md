# S.3.2 作業上の留意事項

## S.3.2 作業上の留意事項

## S.3.2.1 微小ポリゴンについて

3D都市モデルでは、地形モデルは基準地域メッシュ（第三次地域区画、一辺の長さ約1km）を地物の単位とする。

原典資料における地物の単位と異なる場合には、データ変換時に微小ポリゴンが生成される可能性がある。そのため、論理一貫性における位相一貫性の検査（頂点間での距離が近接閾値未満の頂点の検出）を行い、閾値未満の頂点が検出された場合には頂点を統合する処理を行う。

## S.3.2.2 TINの作成

TINの作成はソフトウェアによって、欠落部（河川等）の対岸までTINを生成する場合がある。その場合、生成されたTINから不要な辺を削除する必要がある。

不要な辺は、TINの三角形を構成する辺の正射影の長さが格子の斜辺の長さの最大値よりも長い辺を抽出することで特定できる。

![Image](images/作業上の留意事項__5_img001.png)

## S.3.2.3 高密度点群データによる地形の表現

標準製品仕様書では、地形モデル（LOD1）から地形モデル（LOD3）までは、地形の作成に使用する原典資料の点密度又は標高点格子間隔により決定することとしている。原典資料として高密度点群データを使用する場合も、地形モデルのLOD定義に従った点密度に加工し、地形モデルを作成しなければならない。

そのうえで、原典資料と同様の高密度点群データを3D都市モデルに含めたい場合には、dem:MassPointReliefを使用し、地形モデルとして記述することができる。

## S.3.2.4 ファイルの分割

3D都市モデルでは、一つの地物インスタンスに異なるLODの幾何オブジェクトを含めることで、同一の都市オブジェクトをマルチスケールで表現することが可能である。しかしながら、地形モデルの場合はインスタンスの単位が基準地域メッシュとなるため、一つの地物インスタンスに複数のLODの幾何オブジェクトを含めることでデータ量が膨大となり、操作性が低下する懸念がある。

そこで、地形モデルの中で最も詳細な地形表現が可能となる地形モデル（LOD3）は、ファイルを分けることを許容する。このとき、ファイル名にはオプションの文字列として、lod3を使用する。

なお、分割されたファイルに含まれるそれぞれの地物インスタンスのgml:nameには同じ基準地域メッシュのメッシュ番号が記載されるため、必要に応じて利用者側で一つの地物インスタンスに統合することが可能である。

