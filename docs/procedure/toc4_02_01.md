# 5.2.1 幾何オブジェクトの作成

## 5.2.1 幾何オブジェクトの作成

ここで作成された幾何オブジェクトは附属書Bに示す妥当な幾何オブジェクトの要件を満たさなければならない。また、地物型ごとに取りうる幾何型や満たすべき要件が異なるため、附属書Cから附属書Uに示す地物型ごとの要件を満たすこと。

地物型が取りうる幾何型は、0次元の幾何である点（gml:Point又はgml:MultiPoint）、1次元の幾何である線（gml:MultiCurve）、2次元の幾何である面（gml:MultiSurface）又は、3次元の幾何である立体（gml:Solid）のいずれかである。点、線及び面の作成は、基盤地図情報をはじめとする2次元の地図作成において採用される手法に従う。ここでは、建築物を例として3D都市モデルとして新たに追加される立体（gml:Solid）の作成手順を示す。

なお、幾何オブジェクトの作成においては、各都道府県や市区町村が定める公共測量作業規程又は、作業規程の準則（国土交通省国土地理院）に従うこと。また3Dの立体の図化においては「[3D都市モデル整備のための測量マニュアル](https://www.mlit.go.jp/plateau/libraries/)」を参考とする。

## 5.2.1.1 LOD1のgml:Solidの作成

LOD1の立体を作成する場合、その立体は、外形となるgml:MultiSurfaceを上下の面とする角柱として記述する。

- 【手順】
- 手順1．外形データ（面）を作成する。
 LOD0の幾何オブジェクトが面の場合は、LOD0の幾何オブジェクトを外形データとして使用できる。 
 LOD0の幾何オブジェクトが線（外形線）の場合は、始終点を一致させた面として加工し、外形データとすることができる。
- 手順2．外形データと標高データとを重ね合わせ、最も低い標高を取得する。
標高データには、DEM（数値標高モデル）又は点群データから生成したTIN（不規則三角網）データを使用する。
- 手順3．都市オブジェクトの高さデータを取得する。
- 手順4．外形データの高さ座標として、手順2．で取得した最も低い標高を与えた面を下面、手順3．で取得した高さデータを与えた面を上面とする角柱を作成する（図5-2）。
- 手順5．品質評価を実施する。

![Image](images/toc4_02_01_img001.png)

　

注記5.2.1.1の注記LOD1の立体は、外形データ（面）を一律の高さで押し出して作成することから、プログラムによる自動生成が可能である。

## 5.2.1.2 LOD2のgml:Solidの作成

LOD2では、都市オブジェクトの特徴的な外観が再現される。LOD2として再現すべき都市オブジェクトの形状は、地物型によって異なる。附属書Cから附属書Uに示すLOD2の定義に従うこと。

- 【手順】
- 手順1．都市オブジェクトの外観を構成する各面を取得する。
 LOD2は、建築物の屋根形状のように、都市オブジェクトの上面の形状を詳細化することが基本となる。 
 LOD2に要求される位置正確度を満たす場合には、LOD0やLOD1の幾何オブジェクトを加工し、LOD2の幾何オブジェクトを作成できる。
- 手順2．手順1．で作成した各面を境界とする立体を作成する。
- 手順3．品質評価を実施する。

![Image](images/toc4_02_01_img002.png)

LOD2の立体を作成する場合、立体を構成する境界面がより詳細な地物型（部品）として定義される場合がある。例えば、建築物（bldg:Building）の場合は、その境界面となる屋根面（bldg:RoofSurface）や外壁面（bldg:WallSurface）が該当する（図5-3）。このような場合には、取得した各面を該当する都市オブジェクトに分類する必要がある。

標準製品仕様では、原則としてLOD2.0を採用するが、ユースケースに応じて、LOD2.1やLOD2.2等の詳細なLODを選択できる。

注記5.2.1.2の注記LOD2の立体は、LOD1とは異なり、都市オブジェクトの外観の特徴を再現する必要がある。このとき、LOD0やLOD1の幾何オブジェクトを加工することで効率的にLOD2を作成することができる。

ただし、LOD0やLOD1の幾何オブジェクトを使用する場合には、この位置正確度がLOD2に要求される位置正確度と同等以上でなければならない。例えば、地図情報レベル500の位置正確度がLOD2の幾何オブジェクトに求められている場合、地図情報レベル2500で作成されたLOD1の幾何オブジェクトを使用することはできないが、LOD2の品質要求が地図情報レベル2500である場合には、LOD1の幾何オブジェクトを使用できる。

例1 — 手動によるLOD2建築物の作成手順（DSMに合わせた修正）- LOD1の幾何オブジェクトとDSMを重ねて表示する。
- LOD1の幾何オブジェクトの高さを、建築物の軒下の高さに合わせる。
- 面の分割、押し出し機能等を使用し、DSMに合わせて立体を修正する。

例2 — 自動によるLOD2建物作成手順（専用ソフトウェアを使用した屋根形状へのテンプレート適用）- LOD0の幾何オブジェクトとDSMを重ねる。
- 屋根形状のテンプレート（陸屋根、切妻、寄棟等）を用いてDSMとの一致度が最も高いテンプレートを当てはめる。
- 屋根形状に合わせて壁面を作成する。

## 5.2.1.3 LOD3のgml:Solidの作成

LOD3では、LOD2よりもさらに詳細に都市オブジェクトの詳細な外観が再現される。LOD3として再現すべき都市オブジェクトの形状は、地物型によって異なる。附属書Cから附属書Uに示すLOD3の定義に従うこと。

- 【手順】
- 手順1．都市オブジェクトの外観を構成する各面を取得する。
 LOD3は、建築物の壁面のように、都市オブジェクトの側面の形状を詳細化することが基本となる。 
 LOD3に要求される位置正確度を満たす場合には、LOD2の幾何オブジェクトを加工し、LOD3の幾何オブジェクトを作成できる。
- 手順2．手順1．で作成した各面を境界とする立体を作成する。
- 手順3．品質評価を実施する。

![Image](images/toc4_02_01_img003.png)

LOD3の立体を作成する場合、立体を構成する境界面がより詳細な地物型（部品）として定義される場合がある。例えば、建築物（bldg:Building）の境界面となる屋根面（bldg:RoofSurface）や外壁面（bldg:WallSurface）には、LOD3では窓（bldg:Window）や扉（bldg:Door）を追加できる（図5-4）。このような場合には、取得した各面を該当する都市オブジェクトに分類する必要がある。

LOD3は、都市オブジェクトの外観を記述する最も詳細なLODである。標準製品仕様では、原則としてLOD3.0を採用するが、ユースケースに応じて、LOD3.1やLOD3.2等の詳細なLODを選択できる。

注記5.2.1.3の注記LOD3は、都市オブジェクトの外観を記述する最も詳細なLODである。LOD3を点群データや画像からの図化により作成する場合、その作業量から作成費用が高額となる恐れがある。そのため、ユースケースに応じて、取得対象やその取得の内容を選択することが必要である。

また、LOD3の都市オブジェクトの作成においては、
測量に限らず、BIM（Building Information Modeling）のデータを活用してもよい。 
 BIMデータの活用については、「 [PLATEAU Handbook #03](https://www.mlit.go.jp/plateau/libraries/handbooks/)」を参照するとよい。

## 5.2.1.4 LOD4のgml:Solidの作成

LOD4では、LOD3の詳細な都市オブジェクトの詳細な外観に加えて、都市オブジェクトの内部の形状が再現される。LOD4として再現すべき都市オブジェクトの形状は、地物によって異なる。附属書Cから附属書Uに示すLOD4の定義に従うこと。

- 【手順】
- 手順1．都市オブジェクトの内部の空間を構成する各面を取得する。
- 手順2．手順1．で作成した各面を境界とする立体を作成する。
- 手順3．品質評価を実施する。

![Image](images/toc4_02_01_img004.png)

LOD4は、都市オブジェクトの外観に加えて、内部の形状を再現する最も詳細なLODである（図5-5）。標準製品仕様では、原則としてLOD4.0を採用するが、ユースケースに応じて、LOD4.1やLOD4.2等の詳細なLODを選択できる。

LOD4は都市オブジェクトの内部の形状を再現することから、その作成においてはCADやBIMなどの設計データを活用することが基本となる。ただし、測量により取得できる場合には測量により取得してもよい。

